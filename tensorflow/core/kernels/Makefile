CC = g++

TENSORFLOW_DIR = ../../..
GTEST_DIR = $(TENSORFLOW_DIR)/gmock/gtest/include
THIRD_DIR = $(TENSORFLOW_DIR)/third_party
EIGEN_DIR = $(THIRD_DIR)/eigen-eigen-50812b426b7c
PNG_DIR = $(THIRD_DIR)/png_archive

HEADERS = -I$(TENSORFLOW_DIR) -I$(GTEST_DIR) -I$(THIRD_DIR) -I$(EIGEN_DIR) -I$(EIGEN_DIR)/Eigen -I$(EIGEN_DIR)/unsupported/Eigen/CX11 -I$(PNG_DIR)
CFLAGS = -O2 -Wa,-mbig-obj -std=gnu++11 -DEIGEN_AVOID_STL_ARRAY -DTENSORFLOW_USE_EIGEN_THREADPOOL

TARGET = libTensorflowCoreKernels.a
OBJECTS = adjust_contrast_op.o \
    adjust_contrast_op_gpu.cu.o \
    aggregate_ops.o \
    aggregate_ops_gpu.cu.o \
    argmax_op.o \
    argmax_op_gpu.cu.o \
    attention_ops.o \
    avgpooling_op.o \
    avgpooling_op_gpu.cu.o \
    batchtospace_op.o \
    batchtospace_op_gpu.cu.o \
    batch_matmul_op.o \
    batch_matrix_band_part_op.o \
    batch_matrix_band_part_op_gpu.cu.o \
    batch_matrix_diag_op.o \
    batch_matrix_diag_op_gpu.cu.o \
    batch_norm_op.o \
    batch_norm_op_gpu.cu.o \
    bcast_ops.o \
    bias_op.o \
    bias_op_gpu.cu.o \
    binary_linalg_ops_common.o \
    bitcast_op.o \
    candidate_sampler_ops.o \
    cast_op.o \
    cast_op_gpu.cu.o \
    check_numerics_op.o \
    check_numerics_op_gpu.cu.o \
    cholesky_grad.o \
    cholesky_op.o \
    colorspace_op.o \
    colorspace_op_gpu.cu.o \
    concat_lib_cpu.o \
    concat_lib_gpu.cu.o \
    concat_op.o \
    constant_op.o \
    constant_op_gpu.cu.o \
    control_flow_ops.o \
    conv_grad_ops.o \
    conv_grad_ops_3d.o \
    conv_ops.o \
    conv_ops_3d.o \
    conv_ops_gpu_2.cu.o \
    conv_ops_gpu_3.cu.o \
    count_up_to_op.o \
    cross_op.o \
    cross_op_gpu.cu.o \
    ctc_decoder_ops.o \
    ctc_loss_op.o \
    cudnn_pooling_gpu.o \
    cwise_ops_common.o \
    cwise_op_abs.o \
    cwise_op_add.o \
    cwise_op_ceil.o \
    cwise_op_complex.o \
    cwise_op_conj.o \
    cwise_op_cos.o \
    cwise_op_digamma.o \
    cwise_op_div.o \
    cwise_op_equal_to.o \
    cwise_op_erf.o \
    cwise_op_erfc.o \
    cwise_op_exp.o \
    cwise_op_floor.o \
    cwise_op_gpu_abs.cu.o \
    cwise_op_gpu_add.cu.o \
    cwise_op_gpu_ceil.cu.o \
    cwise_op_gpu_complex.cu.o \
    cwise_op_gpu_conj.cu.o \
    cwise_op_gpu_cos.cu.o \
    cwise_op_gpu_digamma.cu.o \
    cwise_op_gpu_div.cu.o \
    cwise_op_gpu_equal_to.cu.o \
    cwise_op_gpu_erf.cu.o \
    cwise_op_gpu_erfc.cu.o \
    cwise_op_gpu_exp.cu.o \
    cwise_op_gpu_floor.cu.o \
    cwise_op_gpu_greater.cu.o \
    cwise_op_gpu_greater_equal.cu.o \
    cwise_op_gpu_igammas.cu.o \
    cwise_op_gpu_imag.cu.o \
    cwise_op_gpu_inverse.cu.o \
    cwise_op_gpu_isfinite.cu.o \
    cwise_op_gpu_isinf.cu.o \
    cwise_op_gpu_isnan.cu.o \
    cwise_op_gpu_less.cu.o \
    cwise_op_gpu_less_equal.cu.o \
    cwise_op_gpu_lgamma.cu.o \
    cwise_op_gpu_log.cu.o \
    cwise_op_gpu_logical_and.cu.o \
    cwise_op_gpu_logical_not.cu.o \
    cwise_op_gpu_logical_or.cu.o \
    cwise_op_gpu_maximum.cu.o \
    cwise_op_gpu_minimum.cu.o \
    cwise_op_gpu_mod.cu.o \
    cwise_op_gpu_mul.cu.o \
    cwise_op_gpu_neg.cu.o \
    cwise_op_gpu_not_equal_to.cu.o \
    cwise_op_gpu_pow.cu.o \
    cwise_op_gpu_real.cu.o \
    cwise_op_gpu_rsqrt.cu.o \
    cwise_op_gpu_select.cu.o \
    cwise_op_gpu_sigmoid.cu.o \
    cwise_op_gpu_sign.cu.o \
    cwise_op_gpu_sin.cu.o \
    cwise_op_gpu_sqrt.cu.o \
    cwise_op_gpu_square.cu.o \
    cwise_op_gpu_squared_difference.cu.o \
    cwise_op_gpu_sub.cu.o \
    cwise_op_gpu_tanh.cu.o \
    cwise_op_greater.o \
    cwise_op_greater_equal.o \
    cwise_op_igammas.o \
    cwise_op_imag.o \
    cwise_op_inverse.o \
    cwise_op_isfinite.o \
    cwise_op_isinf.o \
    cwise_op_isnan.o \
    cwise_op_less.o \
    cwise_op_less_equal.o \
    cwise_op_lgamma.o \
    cwise_op_log.o \
    cwise_op_logical_and.o \
    cwise_op_logical_not.o \
    cwise_op_logical_or.o \
    cwise_op_maximum.o \
    cwise_op_minimum.o \
    cwise_op_mod.o \
    cwise_op_mul.o \
    cwise_op_neg.o \
    cwise_op_not_equal_to.o \
    cwise_op_pow.o \
    cwise_op_real.o \
    cwise_op_rsqrt.o \
    cwise_op_select.o \
    cwise_op_sigmoid.o \
    cwise_op_sign.o \
    cwise_op_sin.o \
    cwise_op_sqrt.o \
    cwise_op_square.o \
    cwise_op_squared_difference.o \
    cwise_op_sub.o \
    cwise_op_tanh.o \
    decode_csv_op.o \
    decode_jpeg_op.o \
    decode_png_op.o \
    decode_raw_op.o \
    dense_update_ops.o \
    dense_update_ops_gpu.cu.o \
    depthtospace_op.o \
    depthtospace_op_gpu.cu.o \
    depthwise_conv_grad_op.o \
    depthwise_conv_op.o \
    depthwise_conv_op_gpu.cu.o \
    determinant_op.o \
    diag_op.o \
    draw_bounding_box_op.o \
    dynamic_partition_op.o \
    dynamic_stitch_op.o \
    edit_distance_op.o \
    encode_jpeg_op.o \
    encode_png_op.o \
    fact_op.o \
    fft_ops.o \
    fifo_queue.o \
    fifo_queue_op.o \
    fixed_length_record_reader_op.o \
    gather_nd_op.o \
    gather_nd_op_gpu.cu.o \
    gather_op.o \
    gather_op_gpu.cu.o \
    identity_op.o \
    identity_reader_op.o \
    immutable_constant_op.o \
    initializable_lookup_table.o \
    in_topk_op.o \
    l2loss_op.o \
    l2loss_op_gpu.cu.o \
    linalg_ops_common.o \
    listdiff_op.o \
    logging_ops.o \
    lookup_table_init_op.o \
    lookup_table_op.o \
    lookup_util.o \
    lrn_op.o \
    matching_files_op.o \
    matmul_op.o \
    matrix_inverse_op.o \
    matrix_solve_ls_op.o \
    matrix_solve_op.o \
    matrix_triangular_solve_op.o \
    maxpooling_op.o \
    maxpooling_op_gpu.cu.o \
    mirror_pad_op.o \
    mirror_pad_op_gpu.cu.o \
    no_op.o \
    one_hot_op.o \
    one_hot_op_gpu.cu.o \
    ops_testutil.o \
    ops_util.o \
    pack_op.o \
    padding_fifo_queue.o \
    padding_fifo_queue_op.o \
    pad_op.o \
    pad_op_gpu.cu.o \
    pooling_ops_3d.o \
    pooling_ops_common.o \
    queue_base.o \
    queue_ops.o \
    random_crop_op.o \
    random_op.o \
    random_op_gpu.cu.o \
    random_shuffle_op.o \
    random_shuffle_queue_op.o \
    range_sampler.o \
    reader_base.o \
    reader_base.pb.o \
    reader_ops.o \
    reduce_join_op.o \
    reduction_ops_all.o \
    reduction_ops_any.o \
    reduction_ops_common.o \
    reduction_ops_gpu.cu.o \
    reduction_ops_max.o \
    reduction_ops_mean.o \
    reduction_ops_min.o \
    reduction_ops_prod.o \
    reduction_ops_sum.o \
    relu_op.o \
    relu_op_gpu.cu.o \
    reshape_op.o \
    resize_area_op.o \
    resize_bicubic_op.o \
    resize_bilinear_op.o \
    resize_nearest_neighbor_op.o \
    resize_nearest_neighbor_op_gpu.cu.o \
    restore_op.o \
    reverse_op.o \
    reverse_op_gpu.cu.o \
    reverse_sequence_op.o \
    reverse_sequence_op_gpu.cu.o \
    sample_distorted_bounding_box_op.o \
    save_op.o \
    save_restore_tensor.o \
    scatter_op.o \
    scatter_op_gpu.cu.o \
    segment_reduction_ops.o \
    self_adjoint_eig_op.o \
    sendrecv_ops.o \
    sequence_ops.o \
    serialize_sparse_op.o \
    session_ops.o \
    shape_ops.o \
    slice_op.o \
    slice_op_gpu.cu.o \
    softmax_op.o \
    softmax_op_gpu.cu.o \
    softplus_op.o \
    softplus_op_gpu.cu.o \
    softsign_op.o \
    softsign_op_gpu.cu.o \
    spacetobatch_op.o \
    spacetobatch_op_gpu.cu.o \
    spacetodepth_op.o \
    spacetodepth_op_gpu.cu.o \
    sparse_add_grad_op.o \
    sparse_add_op.o \
    sparse_concat_op.o \
    sparse_dense_binary_op_shared.o \
    sparse_matmul_op.o \
    sparse_reduce_sum_op.o \
    sparse_reorder_op.o \
    sparse_split_op.o \
    sparse_tensor_dense_add_op.o \
    sparse_tensor_dense_matmul_op.o \
    sparse_tensor_dense_matmul_op_gpu.cu.o \
    sparse_to_dense_op.o \
    sparse_xent_op.o \
    sparse_xent_op_gpu.cu.o \
    split_lib_cpu.o \
    split_lib_gpu.cu.o \
    split_op.o \
    stack_ops.o \
    string_to_hash_bucket_op.o \
    string_to_number_op.o \
    summary_audio_op.o \
    summary_image_op.o \
    summary_op.o \
    tensor_array.o \
    tensor_array_ops.o \
    text_line_reader_op.o \
    tf_record_reader_op.o \
    tile_ops.o \
    tile_ops_gpu.cu.o \
    topk_op.o \
    training_ops.o \
    training_ops_gpu.cu.o \
    transpose_functor_cpu.o \
    transpose_functor_gpu.cu.o \
    transpose_op.o \
    unique_op.o \
    unpack_op.o \
    variable_ops.o \
    where_op.o \
    whole_file_read_ops.o \
    xent_op.o \
    xent_op_gpu.cu.o \
#    example_parsing_ops.o \

all: $(TARGET)

$(TARGET): $(OBJECTS)
	ar crv $@ $^

$(OBJECTS): %.o: %.cc
	$(CC) $(HEADERS) $(CFLAGS) -c $<

.PHONY : clean
clean:
	rm -rf *.o $(TARGET)